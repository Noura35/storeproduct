
<!--

<%= render "form" ,product: @product %>
-->



<%= form_with model: @product, local: true do |form| %>
  <div>
    <%= form.label :name, 'Product Name' %>
    <%= form.text_field :name %>
  </div>

  <div>
    <%= form.label :price, 'Price' %>
    <%= form.number_field :price, step: 0.01 %>
  </div>

  <div>
    <%= form.label :description, 'Description' %>
    <%= form.text_area :description %>
  </div>

  <div>
    <%= form.label :category, 'Category' %>
    <%= form.collection_select :category_id, @categories, :id, :name, prompt: 'Select a Category' %>
  </div>

  <div id="subcategory_field" style="display: none;">
    <%= form.label :subcategory_id, 'Subcategory' %>
    <%= form.select :subcategory_id, [], {}, id: "subcategory_select" %>
  </div>

  <div>
    <%= form.submit %>
  </div>
<% end %>







<!--
<h1><%= action_name.capitalize %> Product</h1>

<%= form_with(model: @product) do |form| %>
  <% if @product.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@product.errors.count, "error") %> prohibited this product from being saved:</h2>
      <ul>
        <% @product.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= form.label :category_id, 'Category' %>
    <%= form.collection_select :category_id, @categories, :id, :name, prompt: 'Select a category', onchange: 'this.form.submit();' %>
  </div>

  <div class="field">
    <%= form.label :subcategory_id, 'Subcategory' %>
  <%= form.collection_select :subcategory_id, @subcategories || [], :id, :name, prompt: 'Select a subcategory' %>
  </div>

  <div class="field">
    <%= form.label :name %>
    <%= form.text_field :name %>
  </div>

  <div class="field">
    <%= form.label :price %>
    <%= form.number_field :price %>
  </div>


     <%= form.label :Description , class:"block mb-2 text-sm font-medium text-gray-900 "%><br>
       <%= form.text_area :description , class:"block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 ", placeholder:"Your description here" %>  


       <div class="w-full">
                  <%= form.label :image , class:"block mb-2 text-sm font-medium text-gray-900 "%> 
                   <%= form.file_field :file_field , class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5  "%>
              </div>



  <div class="actions">
    <%= form.submit %>
  </div>
<% end %>

<%= link_to 'Back', products_path %>
-->



<script >
document.addEventListener("DOMContentLoaded", () => {
  const categorySelect = document.querySelector("#product_category_id");
  const subcategoryField = document.querySelector("#subcategory_field");
  const subcategorySelect = document.querySelector("#subcategory_select");

  categorySelect.addEventListener("change", (event) => {
    const categoryId = event.target.value;

    if (categoryId) {
      fetch(`/categories/${categoryId}/subcategories`)
        .then(response => response.json())
        .then(data => {
          subcategoryField.style.display = "block";
          subcategorySelect.innerHTML = ""; // Clear previous options

          data.subcategories.forEach(subcategory => {
            const option = document.createElement("option");
            option.value = subcategory.id;
            option.textContent = subcategory.name;
            subcategorySelect.appendChild(option);
          });
        });
    } else {
      subcategoryField.style.display = "none";
    }
  });
});

</script>